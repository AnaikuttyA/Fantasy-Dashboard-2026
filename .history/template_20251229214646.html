<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fantasy Auction Dashboard</title>

<style>
body { font-family: Arial; background:#f4f6f8; padding:20px; }
h1 { margin-bottom: 6px; }
.summary {
  background: white;
  padding: 12px;
  margin-bottom: 20px;
  border-left: 6px solid #111;
  font-size: 16px;
}
table { width:100%; border-collapse:collapse; background:white; }
th,td { border:1px solid #ccc; padding:6px; text-align:center; }
th { background:#111; color:white; position: sticky; top: 0; }
input { padding:6px; margin:4px; width:220px; }
.table-container { overflow-x:auto; max-height:500px; overflow-y:auto; }
</style>
</head>

<body>

<h1>üèè Fantasy Auction Dashboard</h1>

<div class="summary">
  <strong>Matches Completed:</strong> {{MATCHES_COMPLETED}}
</div>

<h2>Team Rankings</h2>
<table>
<thead>
<tr>
  <th>Rank</th>
  <th>Team</th>
  <th>Points</th>
</tr>
</thead>
<tbody id="rankBody"></tbody>
</table>

<h2>Player Match-wise Points</h2>

<input id="matchFilter" placeholder="Filter Match ID">
<input id="playerFilter" placeholder="Filter Player">
<input id="teamFilter" placeholder="Filter Auction Team">

<div class="table-container">
<table>
<thead id="pointsHead"></thead>
<tbody id="pointsBody"></tbody>
</table>
</div>

<script>
/* ===== DATA (INJECTED BY PYTHON) ===== */
const rankData = {{RANK_DATA}};
const pointsData = {{POINTS_DATA}};

/* ===== RANK TABLE ===== */
rankBody.innerHTML = rankData.map(r =>
  `<tr>
    <td>${r.rank}</td>
    <td>${r.teams}</td>
    <td>${r.points}</td>
  </tr>`
).join("");

/* ===== POINTS TABLE ===== */
function buildPointsTable(data){
  if(data.length === 0){
    pointsHead.innerHTML = "";
    pointsBody.innerHTML = "<tr><td>No data</td></tr>";
    return;
  }

  const cols = Object.keys(data[0]);
  pointsHead.innerHTML =
    "<tr>" + cols.map(c => `<th>${c}</th>`).join("") + "</tr>";

  pointsBody.innerHTML = data.map(row =>
    "<tr>" + cols.map(c => `<td>${row[c]}</td>`).join("") + "</tr>"
  ).join("");
}

/* ===== FILTERS ===== */
function applyFilters(){
  const m = matchFilter.value.toLowerCase();
  const p = playerFilter.value.toLowerCase();
  const t = teamFilter.value.toLowerCase();

  buildPointsTable(
    pointsData.filter(r =>
      String(r.match_id).toLowerCase().includes(m) &&
      String(r.player).toLowerCase().includes(p) &&
      String(r.auction_team || "").toLowerCase().includes(t)
    )
  );
}

matchFilter.oninput = applyFilters;
playerFilter.oninput = applyFilters;
teamFilter.oninput = applyFilters;

/* INITIAL LOAD */
buildPointsTable(pointsData);
</script>

</body>
</html>
