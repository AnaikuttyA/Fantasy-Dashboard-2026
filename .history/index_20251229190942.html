<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fantasy Auction Dashboard</title>

<style>
body { font-family: Arial; background:#f4f6f8; padding:20px; }
h1 { margin-bottom: 5px; }
.summary {
  background: white;
  padding: 12px;
  margin-bottom: 20px;
  border-left: 6px solid #111;
  font-size: 16px;
}
table { width:100%; border-collapse:collapse; background:white; }
th,td { border:1px solid #ccc; padding:6px; text-align:center; }
th { background:#111; color:white; position: sticky; top: 0; }
input { padding:6px; margin:6px 0; width: 250px; }
.table-container { overflow-x:auto; }
</style>
</head>

<body>

<h1>üèè Fantasy Auction Dashboard</h1>

<div class="summary">
  <strong>Matches Completed:</strong> {{MATCHES_COMPLETED}}
</div>

<h2>Team Rankings</h2>
<table>
<thead>
<tr><th>Rank</th><th>Team</th><th>Points</th></tr>
</thead>
<tbody id="rankBody"></tbody>
</table>

<h2>Player Match-wise Points (All Columns)</h2>

<input id="globalFilter" placeholder="Search any column">

<div class="table-container">
<table id="pointsTable">
  <thead id="pointsHead"></thead>
  <tbody id="pointsBody"></tbody>
</table>
</div>

<script>
const rankData = {{RANK_DATA}} || [];
const pointsData = {{POINTS_DATA}} || [];

/* ---------- RANK TABLE ---------- */
rankBody.innerHTML = rankData.map(r =>
  `<tr><td>${r.rank}</td><td>${r.teams}</td><td>${r.points}</td></tr>`
).join("");

/* ---------- DYNAMIC POINTS TABLE ---------- */
function buildPointsTable(data) {
  if (data.length === 0) {
    pointsHead.innerHTML = "";
    pointsBody.innerHTML = "<tr><td>No data available</td></tr>";
    return;
  }

  const columns = Object.keys(data[0]);

  pointsHead.innerHTML = "<tr>" +
    columns.map(col => `<th>${col}</th>`).join("") +
    "</tr>";

  pointsBody.innerHTML = data.map(row =>
    "<tr>" +
    columns.map(col => `<td>${row[col]}</td>`).join("") +
    "</tr>"
  ).join("");
}

/* ---------- GLOBAL FILTER ---------- */
globalFilter.oninput = function () {
  const value = this.value.toLowerCase();
  const filtered = pointsData.filter(row =>
    Object.values(row).some(v =>
      String(v).toLowerCase().includes(value)
    )
  );
  buildPointsTable(filtered);
};

buildPointsTable(pointsData);
</script>

</body>
</html>
